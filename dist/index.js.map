{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/index.js","webpack:///./src/DragData.js","webpack:///./src/dragging.js","webpack:///./src/domUtils.js","webpack:///./src/style.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Vue","options","dragData","DragData","Current","getBlockEl","el","getAttribute","ELEMENT_ATTRS","DRAG_GROUP","new","DRAG_BLOCK","parentNode","handleDragStart","e","target","valid","className","domUtils","getElementFromMouseEvent","hasClass","validateEl","dragKey","DRAG_KEY","_dragData","item","KEY_MAP","index","list","indexOf","setStyle","dragStyles","dragging","dataTransfer","effectAllowed","setData","JSON","stringify","group","preventDefault","handleDragOver","handleDragEnter","indexTo","indexFrom","items","set","swapArrayElements","$dragging","$emit","dragged","to","handleDragLeave","handleDrag","handleDragEnd","resetStyle","handleDrop","stopPropagation","assign","directive","binding","vnode","_binding$value","setAttribute","DRAGGABLE","on","update","_binding$value2","oldItem","unbind","off","_classCallCheck","this","data","listeners","$on","event","func","push","$once","vm","$off","_len","arguments","length","args","Array","_key","apply","filter","_len2","_key2","events","forEach","fun","eleStyleMap","Map","type","fn","addEventListener","removeEventListener","attr","currentStyle","getComputedStyle","str","replace","$","$1","toUpperCase","style","originalStyle","String","split","_style","_style$split","_style$split2","_slicedToArray","toCamel","getStyle","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","entries","iterator","next","done","_ref","_ref2","err","return","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_ref3","cls","RegExp","test","pageX","pageY","document","elementFromPoint","cursor","transform","dragOvering"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/**\r\n * @description 元素可拖拽\r\n * @author      tangerine\r\n */\r\n\r\nimport DragData from './DragData';\r\nimport $dragging from './dragging';\r\nimport domUtils from './domUtils';\r\nimport dragStyles from './style';\r\n\r\nconst ELEMENT_ATTRS = {\r\n  // 是否可拖拽 html5属性\r\n  DRAGGABLE: 'draggable',\r\n  // 拖拽目标确定\r\n  DRAG_BLOCK: 'drag_block',\r\n  // 拖拽分组\r\n  DRAG_GROUP: 'drag_group',\r\n  // 标识\r\n  DRAG_KEY: 'drag_key'\r\n};\r\n\r\nexport default function (Vue, options) {\r\n  const dragData = new DragData();\r\n  let Current = null;\r\n\r\n  /**\r\n   * 合并自定义样式\r\n   */\r\n  if (\r\n    options\r\n    && options instanceof Object\r\n  ) {\r\n    Object.assign(dragStyles, options);\r\n  }\r\n\r\n  /**\r\n   * 获取元素\r\n   */\r\n  function getBlockEl(el) {\r\n    if (!el) {\r\n      return null;\r\n    }\r\n\r\n    const key = el.getAttribute(ELEMENT_ATTRS.DRAG_GROUP);\r\n    const _dragData = dragData.new(key);\r\n\r\n    while (el) {\r\n      if (\r\n        el.getAttribute\r\n        && el.getAttribute(ELEMENT_ATTRS.DRAG_BLOCK)\r\n      ) {\r\n        return el;\r\n      // eslint-disable-next-line no-else-return\r\n      } else {\r\n        el = el.parentNode;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * 验证元素是否合法: 拖拽是否在指定className元素之上\r\n   */\r\n  function validateEl(e) {\r\n    const key = e.target.getAttribute(ELEMENT_ATTRS.DRAG_GROUP);\r\n    const _dragData = dragData.new(key);\r\n    const { className } = _dragData;\r\n    let el = domUtils.getElementFromMouseEvent(e);\r\n\r\n    if (!className) {\r\n      return true;\r\n    }\r\n\r\n    while (el) {\r\n      if (domUtils.hasClass(el, className)) {\r\n        return true;\r\n      } else if (el == e.target) {\r\n        return false;\r\n      } else {\r\n        el = el.parentNode;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * 交换数组item\r\n   */\r\n  function swapArrayElements(items, indexFrom, indexTo) {\r\n    const item = items[indexTo];\r\n\r\n    Vue.set(items, indexTo, items[indexFrom]);\r\n    Vue.set(items, indexFrom, item);\r\n  }\r\n\r\n  /**\r\n   * 处理拖拽开始\r\n   */\r\n  function handleDragStart(e) {\r\n    const el = getBlockEl(e.target);\r\n    const valid = validateEl(e);\r\n\r\n    if (!(el && valid)) {\r\n      e.preventDefault();\r\n\r\n      return;\r\n    }\r\n\r\n    const key = el.getAttribute(ELEMENT_ATTRS.DRAG_GROUP);\r\n    const dragKey = el.getAttribute(ELEMENT_ATTRS.DRAG_KEY);\r\n    const _dragData = dragData.new(key);\r\n    const item = _dragData.KEY_MAP[dragKey];\r\n    const index = _dragData.list.indexOf(item);\r\n\r\n    domUtils.setStyle(\r\n      el,\r\n      dragStyles.dragging\r\n    );\r\n\r\n    if (e.dataTransfer) {\r\n      e.dataTransfer.effectAllowed = 'move';\r\n      e.dataTransfer.setData('text', JSON.stringify(item));\r\n    }\r\n\r\n    Current = {\r\n      group: key,\r\n      index,\r\n      item,\r\n      el,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 处理拖拽Over\r\n   */\r\n  function handleDragOver(e) {\r\n    if (e.preventDefault) {\r\n      e.preventDefault();\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * 处理拖拽进入\r\n   */\r\n  function handleDragEnter(e) {\r\n    const el = getBlockEl(e.target);\r\n\r\n    if (!el) {\r\n      e.preventDefault();\r\n\r\n      return;\r\n    }\r\n\r\n    if (!el ||\r\n      !Current\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    const key = el.getAttribute(ELEMENT_ATTRS.DRAG_GROUP);\r\n    if (\r\n      key != Current.group ||\r\n      !Current.el ||\r\n      !Current.item ||\r\n      el == Current.el\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    const dragKey = el.getAttribute(ELEMENT_ATTRS.DRAG_KEY);\r\n    const _dragData = dragData.new(key);\r\n    const item = _dragData.KEY_MAP[dragKey];\r\n\r\n    if (item == Current.item) {\r\n      return;\r\n    }\r\n\r\n    const indexTo = _dragData.list.indexOf(item);\r\n    const indexFrom = _dragData.list.indexOf(Current.item);\r\n    swapArrayElements(_dragData.list, indexFrom, indexTo);\r\n\r\n    Current.index = indexTo;\r\n    $dragging.$emit('dragged', {\r\n      dragged: Current.item,\r\n      to: item,\r\n      value: _dragData.value,\r\n      group: key\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 处理拖拽离开\r\n   */\r\n  function handleDragLeave(e) {\r\n  }\r\n\r\n  /**\r\n   * 处理拖拽\r\n   */\r\n  function handleDrag(e) {\r\n  }\r\n\r\n  /**\r\n   * 处理拖拽结束\r\n   */\r\n  function handleDragEnd(e) {\r\n    const el = getBlockEl(e.target);\r\n\r\n    if (!el) {\r\n      e.preventDefault();\r\n\r\n      return;\r\n    }\r\n\r\n    domUtils.resetStyle(\r\n      el,\r\n      dragStyles.dragging\r\n    );\r\n\r\n    Current = null;\r\n    const group = el.getAttribute(ELEMENT_ATTRS.DRAG_GROUP);\r\n    $dragging.$emit('dragend', {\r\n      group\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 处理拖拽Drop\r\n   */\r\n  function handleDrop(e) {\r\n    e.preventDefault();\r\n    if (e.stopPropagation) {\r\n      e.stopPropagation();\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * 使元素可拖拽\r\n   */\r\n  function addDragItem(el, binding, vnode) {\r\n    const {\r\n      item,\r\n      list,\r\n      group,\r\n      className\r\n    } = binding.value;\r\n    const _dragData = dragData.new(group);\r\n    const dragKey = vnode.key || binding.value.key;\r\n\r\n    _dragData.value = binding.value;\r\n    _dragData.className = className;\r\n    _dragData.KEY_MAP[dragKey] = item;\r\n\r\n    if (list && list != _dragData.list) {\r\n      _dragData.list = list;\r\n    }\r\n\r\n    el.setAttribute(ELEMENT_ATTRS.DRAGGABLE, true);\r\n    el.setAttribute(ELEMENT_ATTRS.DRAG_GROUP, group);\r\n    el.setAttribute(ELEMENT_ATTRS.DRAG_BLOCK, group);\r\n    el.setAttribute(ELEMENT_ATTRS.DRAG_KEY, dragKey);\r\n\r\n    domUtils.on(el, 'dragstart', handleDragStart);\r\n    domUtils.on(el, 'dragenter', handleDragEnter);\r\n    domUtils.on(el, 'dragover', handleDragOver);\r\n    domUtils.on(el, 'drag', handleDrag);\r\n    domUtils.on(el, 'dragleave', handleDragLeave);\r\n    domUtils.on(el, 'dragend', handleDragEnd);\r\n    domUtils.on(el, 'drop', handleDrop);\r\n  }\r\n\r\n  /**\r\n   * 使元素失去拖拽\r\n   */\r\n  function removeDragItem(el, binding, vnode) {\r\n    const _dragData = dragData.new(binding.value.group);\r\n    const dragKey = vnode.key || binding.value.key;\r\n\r\n    delete _dragData.KEY_MAP[dragKey];\r\n\r\n    domUtils.off(el, 'dragstart', handleDragStart);\r\n    domUtils.off(el, 'dragenter', handleDragEnter);\r\n    domUtils.off(el, 'dragover', handleDragOver);\r\n    domUtils.off(el, 'drag', handleDrag);\r\n    domUtils.off(el, 'dragleave', handleDragLeave);\r\n    domUtils.off(el, 'dragend', handleDragEnd);\r\n    domUtils.off(el, 'drop', handleDrop);\r\n  }\r\n\r\n  Vue.prototype.$dragging = $dragging;\r\n  Vue.directive('dragToLayout', {\r\n    bind: addDragItem,\r\n    update(el, binding, vnode) {\r\n      const {\r\n        group, item, list, className\r\n      } = binding.value;\r\n      const _dragData = dragData.new(group);\r\n      const dragKey = vnode.key || binding.value.key;\r\n      const oldItem = _dragData.KEY_MAP[dragKey];\r\n\r\n      if (\r\n        item &&\r\n        item != oldItem\r\n      ) {\r\n        _dragData.KEY_MAP[dragKey] = item;\r\n      }\r\n\r\n      if (\r\n        list &&\r\n        list != _dragData.list\r\n      ) {\r\n        _dragData.list = list;\r\n      }\r\n\r\n      _dragData.className = className;\r\n    },\r\n    unbind: removeDragItem\r\n  });\r\n}\r\n","/**\r\n * @description DragData\r\n * @author      tangerine\r\n */\r\n\r\nclass DragData {\r\n  constructor() {\r\n    this.data = {};\r\n  }\r\n\r\n  new(key) {\r\n    if (!this.data[key]) {\r\n      this.data[key] = {\r\n        className: '',\r\n        list: [],\r\n        KEY_MAP: {}\r\n      };\r\n    }\r\n\r\n    return this.data[key];\r\n  }\r\n\r\n  get(key) {\r\n    return this.data[key];\r\n  }\r\n}\r\n\r\nexport default DragData;\r\n","/**\r\n * @description 事件监听\r\n * @author      tangerine\r\n */\r\n\r\nconst $dragging = {\r\n  listeners: {},\r\n  $on(event, func) {\r\n    const events = this.listeners[event];\r\n\r\n    if (!events) {\r\n      this.listeners[event] = [];\r\n    }\r\n\r\n    this.listeners[event].push(func);\r\n  },\r\n  $once(event, func) {\r\n    const vm = this;\r\n\r\n    function on(...args) {\r\n      vm.$off(event, on);\r\n      func.apply(vm, args);\r\n    }\r\n\r\n    this.$on(event, on);\r\n  },\r\n  $off(event, func) {\r\n    const events = this.listeners[event];\r\n\r\n    if (!events || !func) {\r\n      this.listeners[event] = [];\r\n\r\n      return;\r\n    }\r\n\r\n    this.listeners[event] = this.listeners[event].filter(i => i !== func);\r\n  },\r\n  $emit(event, ...args) {\r\n    const events = this.listeners[event];\r\n\r\n    if (\r\n      events &&\r\n      events.length\r\n    ) {\r\n      events.forEach(fun => fun(...args));\r\n    }\r\n  }\r\n};\r\n\r\nexport default $dragging;\r\n","/**\r\n * @description DOM工具\r\n * @author      tangerine\r\n */\r\n\r\nconst eleStyleMap = new Map();\r\n\r\nclass domUtils {\r\n  static on(el, type, fn) {\r\n    el.addEventListener(type, fn);\r\n  }\r\n\r\n  static off(el, type, fn) {\r\n    el.removeEventListener(type, fn);\r\n  }\r\n\r\n  static getStyle(el, attr) {\r\n    return el.currentStyle\r\n      ? el.currentStyle[attr]\r\n      : getComputedStyle(el, null)[attr];\r\n  }\r\n\r\n  static toCamel(str) {\r\n    return str.replace(/\\\\-([a-zA-Z])/g, ($, $1) => $1.toUpperCase());\r\n  }\r\n\r\n  static setStyle(el, style) {\r\n    const originalStyle = eleStyleMap.get(el) || {};\r\n\r\n    if (style instanceof String) {\r\n      // eg: 'margin-left: 10px; height: 10px;'\r\n      style.split(/\\s*;\\s*/g).forEach((_style) => {\r\n        const [attr, value] = _style.split(/\\s*:\\s*/g);\r\n\r\n        originalStyle[domUtils.toCamel(attr)] = domUtils.getStyle(el, attr);\r\n        el.style[domUtils.toCamel(attr)] = value;\r\n      });\r\n    }\r\n\r\n    if (style instanceof Object) {\r\n      // eg: { marginLeft: '10px', height: '10px' }\r\n      //eslint-disable-next-line no-restricted-syntax\r\n      for (const [attr, value] of Object.entries(style)) {\r\n        originalStyle[domUtils.toCamel(attr)] = domUtils.getStyle(el, attr);\r\n        el.style[domUtils.toCamel(attr)] = value;\r\n      }\r\n    }\r\n\r\n    eleStyleMap.set(el, originalStyle);\r\n  }\r\n\r\n  static resetStyle(el, style) {\r\n    // style: eg: { marginLeft: '10px', height: '10px' }\r\n    const originalStyle = eleStyleMap.get(el) || {};\r\n\r\n    if (style instanceof Object) {\r\n      //eslint-disable-next-line no-restricted-syntax\r\n      for (const [attr] of Object.entries(style)) {\r\n        el.style[domUtils.toCamel(attr)] = originalStyle[domUtils.toCamel(attr)] || 'none';\r\n      }\r\n    }\r\n  }\r\n\r\n  static hasClass(el, cls) {\r\n    const { className } = el;\r\n\r\n    return (new RegExp(`\\\\b${cls}\\\\b`)).test(className);\r\n  }\r\n\r\n  static getElementFromMouseEvent(e) {\r\n    const { pageX, pageY } = e;\r\n\r\n    return document.elementFromPoint(pageX, pageY);\r\n  }\r\n}\r\n\r\nexport default domUtils;\r\n","/**\r\n * @description 样式文件\r\n * @author      tangerine\r\n */\r\n\r\nconst styles = {\r\n  dragging: {\r\n    cursor: '-webkit-grabbing',\r\n    transform: 'scale(1.1)'\r\n  },\r\n  dragOvering: {\r\n  },\r\n};\r\n\r\nexport default styles;\r\n"],"sourceRoot":""}